{"version":3,"file":"src_app_pages_select-shop_select-shop_module_ts.js","mappings":"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","sources":["./src/app/guards/is-shop.guard.ts","./src/app/pages/select-shop/select-shop.module.ts","./src/app/pages/select-shop/select-shop.page.ts","./src/app/services/branch.service.ts","./src/app/pages/select-shop/select-shop.page.html"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport {\r\n  ActivatedRouteSnapshot,\r\n  CanActivate,\r\n  Router,\r\n  RouterStateSnapshot,\r\n} from '@angular/router';\r\nimport { StorageService } from '../services/storage.service';\r\nimport { appUrl } from '../app-url.module';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class IsShopGuard implements CanActivate {\r\n  constructor(private router: Router, private storageService: StorageService) {}\r\n\r\n  async canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot) {\r\n    const isShop = await this.storageService.storageData('shop');\r\n    const isBranch = await this.storageService.storageData('branch');\r\n\r\n    if (isShop && isBranch) {\r\n      return this.router.navigate([appUrl.home]);\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { AuthGuard } from 'src/app/guards/auth.guard';\nimport { IsShopGuard } from 'src/app/guards/is-shop.guard';\n\nimport { SelectShopPage } from './select-shop.page';\n\n@NgModule({\n  imports: [\n    SharedModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        component: SelectShopPage,\n        canActivate: [AuthGuard, IsShopGuard],\n      },\n    ]),\n  ],\n  declarations: [SelectShopPage],\n})\nexport class SelectShopPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { map } from 'rxjs/operators';\nimport { appUrl } from 'src/app/app-url.module';\nimport { Branch } from 'src/app/models/branch.model';\nimport { IUserLogin } from 'src/app/models/user-login.model';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { BranchService } from 'src/app/services/branch.service';\nimport { StorageService } from 'src/app/services/storage.service';\nimport { UserService } from 'src/app/services/user.service';\nimport { imagePath } from 'src/environments/environment.prod';\n\n@Component({\n  selector: 'app-select-shop',\n  templateUrl: './select-shop.page.html',\n  styleUrls: ['./select-shop.page.scss'],\n})\nexport class SelectShopPage implements OnInit {\n  loading = false;\n\n  imgPath = imagePath;\n  userLogin!: IUserLogin;\n  branches: Branch[] = [];\n\n  constructor(\n    private router: Router,\n    private userService: UserService,\n    private branchService: BranchService,\n    private authService: AuthService,\n    private storageService: StorageService\n  ) {}\n\n  ngOnInit() {\n    this.initializeApp();\n  }\n\n  async initializeApp() {\n    const shop = await this.storageService.storageData('shop');\n    const branch = await this.storageService.storageData('branch');\n\n    if (shop && branch) {\n      return this.router.navigate([appUrl.home]);\n    }\n\n    await this.onFetchProfile();\n    await this.onFetchBranch();\n  }\n\n  onFetchBranch() {\n    this.loading = true;\n    this.branchService\n      .getBranchUser()\n      .pipe(map((val) => val.branch))\n      .subscribe({\n        next: (data) => {\n          this.branches = data;\n        },\n        error: () => {\n          this.loading = false;\n        },\n        complete: () => {\n          this.loading = false;\n        },\n      });\n  }\n\n  onFetchProfile() {\n    this.userService.getUserLogin().subscribe({\n      next: (data) => {\n        this.userLogin = data;\n      },\n      error: () => {},\n      complete: () => {},\n    });\n  }\n\n  saveShop(branch: Branch) {\n    this.authService.saveShop(branch);\n  }\n\n  signOut() {\n    this.authService.signOut();\n  }\n}\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { Branch } from '../models/branch.model';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class BranchService {\r\n  private url = 'branches';\r\n  constructor(private http: HttpClient) {}\r\n\r\n  getBranchUser(): Observable<{ branch: Branch[] }> {\r\n    return this.http.get<{ branch: Branch[] }>(this.url + '/user');\r\n  }\r\n}\r\n","export default \"<ion-content>\\n  <div class=\\\"branch-page\\\">\\n    <div class=\\\"branch-header-container\\\">\\n      <div class=\\\"branch-sign\\\">\\n        <ion-button\\n          (click)=\\\"signOut()\\\"\\n          color=\\\"light\\\"\\n          shape=\\\"circle\\\"\\n          fill=\\\"clear\\\"\\n        >\\n          <ion-icon name=\\\"log-out-outline\\\"></ion-icon>\\n        </ion-button>\\n      </div>\\n      <ng-container *ngIf=\\\"userLogin as user\\\">\\n        <div class=\\\"branch-header\\\">\\n          <div class=\\\"branch-header-circle\\\">\\n            <span> ອສ </span>\\n          </div>\\n          <div class=\\\"branch-header-data\\\">\\n            <h1>\\n              ຊື່ເຈົ້າຂອງ : {{user.Profile.firstname}} {{user.Profile.lastname}}\\n            </h1>\\n            <p>ເບີໂທ: {{user.Profile.phone}}</p>\\n          </div>\\n        </div>\\n      </ng-container>\\n    </div>\\n  </div>\\n  <div class=\\\"ion-padding\\\">\\n    <ng-container *ngIf=\\\"branches.length && !loading; else loadingTemplate\\\">\\n      <div class=\\\"shop-list\\\">\\n        <ion-grid>\\n          <ion-row>\\n            <!-- <ng-container > -->\\n            <ion-col\\n              *ngFor=\\\"let branch of branches\\\"\\n              size=\\\"12\\\"\\n              sizeLg=\\\"4\\\"\\n              sizeMd=\\\"6\\\"\\n              sizeSm=\\\"6\\\"\\n            >\\n              <ion-card (click)=\\\"saveShop(branch)\\\">\\n                <div class=\\\"ion-activatable ripple-parent rounded-rectangle\\\">\\n                  <ion-ripple-effect></ion-ripple-effect>\\n                  <div class=\\\"card-body\\\">\\n                    <div class=\\\"card-img\\\">\\n                      <img [src]=\\\"imgPath(branch.logo)\\\" [alt]=\\\"branch.name\\\" />\\n                    </div>\\n                    <div class=\\\"card-title\\\">\\n                      <h2>ຮ້ານ {{branch.name}}</h2>\\n                      <ion-chip color=\\\"primary\\\">\\n                        <ion-icon name=\\\"checkmark-circle\\\"></ion-icon>\\n                        <ion-label> {{branch.isStatus}} </ion-label>\\n                      </ion-chip>\\n                    </div>\\n                  </div>\\n                </div>\\n              </ion-card>\\n            </ion-col>\\n            <!-- </ng-container> -->\\n          </ion-row>\\n        </ion-grid>\\n      </div>\\n    </ng-container>\\n\\n    <ng-template #loadingTemplate>\\n      <ng-container *ngIf=\\\"!branches.length && loading; else emptyTemplate\\\">\\n        <div class=\\\"text-center\\\">\\n          <ion-spinner color=\\\"primary\\\"></ion-spinner>\\n        </div>\\n      </ng-container>\\n    </ng-template>\\n    <ng-template #emptyTemplate>\\n      <div class=\\\"text-center\\\">\\n        <h4 class=\\\"empty-data\\\">ບໍ່ພົບຂໍ້ມູນ</h4>\\n      </div>\\n    </ng-template>\\n  </div>\\n</ion-content>\\n\";"],"names":[],"sourceRoot":"webpack:///"}